= Multi-OMICs Data Integration

== Scenario

Building on the single omics foundation, we now extend the integration to support multiple omics layers such as proteomics and metabolomics. By mapping relationships between genes, their protein products, and metabolic pathways, the knowledge graph captures the full spectrum from transcriptomics through proteomics to metabolomic contexts. This unified representation enables researchers to trace molecular changes across different omics types and gain holistic insights into biological systems and disease mechanisms.

== Data Model

image::life-sciences/research-development/Industry_Use_Cases_multi-OMICs.svg[Multi-OMICs data model]
== Demo Data

The following Cypher statements will create the example graph in the Neo4j database:

[source, cypher, role=noheader]
----
// Create Projects
CREATE (p1:Project {sid: "PROJ001", name: "Liver Disease Study"})
CREATE (p2:Project {sid: "PROJ002", name: "Diabetes Research"})

// Create Tissues
CREATE (t1:Tissue {sid: "UBERON:0002107", name: "Liver"})
CREATE (t2:Tissue {sid: "UBERON:0001264", name: "Pancreas"})

// Create Diseases
CREATE (d1:Disease {sid: "MONDO:0005359", name: "Non-alcoholic fatty liver disease"})
CREATE (d2:Disease {sid: "MONDO:0005015", name: "Type 2 Diabetes"})

// Create Phenotypes (EFO)
CREATE (ph1:EFO {sid: "EFO:0004220", name: "Insulin resistance"})
CREATE (ph2:EFO {sid: "EFO:0001421", name: "Elevated triglycerides"})

// Create Samples
CREATE (s1:Sample {sid: "SAMPLE001", name: "Patient_001_Liver"})
CREATE (s2:Sample {sid: "SAMPLE002", name: "Control_001_Liver"})
CREATE (s3:Sample {sid: "SAMPLE003", name: "Patient_002_Pancreas"})
CREATE (s4:Sample {sid: "SAMPLE004", name: "Control_002_Pancreas"})

// Create Experiments
CREATE (e1:Experiment {sid: "EXP001", type: "RNA-seq"})
CREATE (e2:Experiment {sid: "EXP002", type: "RNA-seq"})

// Create Comparisons
CREATE (comp1:Comparison {sid: "COMP001", name: "NAFLD vs Control", type: "disease_vs_control"})
CREATE (comp2:Comparison {sid: "COMP002", name: "T2D vs Control", type: "disease_vs_control"})

// Create Genes with expression data
CREATE (g1:Gene {sid: "ENSG00000105851", symbol: "PIK3CG", source: "Ensembl"})
CREATE (g2:Gene {sid: "ENSG00000169245", symbol: "CXCL10", source: "Ensembl"})
CREATE (g3:Gene {sid: "ENSG00000198793", symbol: "MTOR", source: "Ensembl"})
CREATE (g4:Gene {sid: "ENSG00000134108", symbol: "AKT1", source: "Ensembl"})
CREATE (g5:Gene {sid: "ENSG00000171408", symbol: "PPARG", source: "Ensembl"})

// Create IDs (alternative identifiers)
CREATE (id1:ID {sid: "5294", source: "NCBI"})
CREATE (id2:ID {sid: "3627", source: "NCBI"})
CREATE (id3:ID {sid: "2475", source: "NCBI"})

// Create Proteins
CREATE (pr1:Protein {sid: "P48736", source: "UniProt"})
CREATE (pr2:Protein {sid: "P02778", source: "UniProt"})
CREATE (pr3:Protein {sid: "P42345", source: "UniProt"})
CREATE (pr4:Protein {sid: "P31749", source: "UniProt"})
CREATE (pr5:Protein {sid: "P37231", source: "UniProt"})

// Create GO terms
CREATE (go1:GO {sid: "GO:0005158", name: "insulin receptor binding"})
CREATE (go2:GO {sid: "GO:0006954", name: "inflammatory response"})
CREATE (go3:GO {sid: "GO:0043066", name: "negative regulation of apoptosis"})
CREATE (go4:GO {sid: "GO:0008286", name: "insulin receptor signaling pathway"})

// Connect Project -> Sample
MATCH (p:Project {sid: "PROJ001"}), (s:Sample {sid: "SAMPLE001"})
CREATE (p)-[:HAS_SAMPLE]->(s)
MATCH (p:Project {sid: "PROJ001"}), (s:Sample {sid: "SAMPLE002"})
CREATE (p)-[:HAS_SAMPLE]->(s)
MATCH (p:Project {sid: "PROJ002"}), (s:Sample {sid: "SAMPLE003"})
CREATE (p)-[:HAS_SAMPLE]->(s)
MATCH (p:Project {sid: "PROJ002"}), (s:Sample {sid: "SAMPLE004"})
CREATE (p)-[:HAS_SAMPLE]->(s)

// Connect Sample -> Tissue
MATCH (s:Sample {sid: "SAMPLE001"}), (t:Tissue {sid: "UBERON:0002107"})
CREATE (s)-[:TAKEN_FROM]->(t)
MATCH (s:Sample {sid: "SAMPLE002"}), (t:Tissue {sid: "UBERON:0002107"})
CREATE (s)-[:TAKEN_FROM]->(t)
MATCH (s:Sample {sid: "SAMPLE003"}), (t:Tissue {sid: "UBERON:0001264"})
CREATE (s)-[:TAKEN_FROM]->(t)

// Connect Sample -> Phenotype
MATCH (s:Sample {sid: "SAMPLE001"}), (ph:EFO {sid: "EFO:0001421"})
CREATE (s)-[:HAS_PHENOTYPE]->(ph)
MATCH (s:Sample {sid: "SAMPLE003"}), (ph:EFO {sid: "EFO:0004220"})
CREATE (s)-[:HAS_PHENOTYPE]->(ph)

// Connect Sample -> Experiment
MATCH (s:Sample {sid: "SAMPLE001"}), (e:Experiment {sid: "EXP001"})
CREATE (s)-[:HAS_EXPERIMENT]->(e)
MATCH (s:Sample {sid: "SAMPLE002"}), (e:Experiment {sid: "EXP001"})
CREATE (s)-[:HAS_EXPERIMENT]->(e)
MATCH (s:Sample {sid: "SAMPLE003"}), (e:Experiment {sid: "EXP002"})
CREATE (s)-[:HAS_EXPERIMENT]->(e)

// Connect Comparison -> Experiment
MATCH (c:Comparison {sid: "COMP001"}), (e:Experiment {sid: "EXP001"})
CREATE (c)-[:COMPARES]->(e)
MATCH (c:Comparison {sid: "COMP002"}), (e:Experiment {sid: "EXP002"})
CREATE (c)-[:COMPARES]->(e)

// Connect Experiment -> Gene (with expression values)
MATCH (e:Experiment {sid: "EXP001"}), (g:Gene {symbol: "PIK3CG"})
CREATE (e)-[:HAS_VALUE {foldChange: 2.5, pValue: 0.001, regulated: "up"}]->(g)
MATCH (e:Experiment {sid: "EXP001"}), (g:Gene {symbol: "CXCL10"})
CREATE (e)-[:HAS_VALUE {foldChange: 3.2, pValue: 0.0005, regulated: "up"}]->(g)
MATCH (e:Experiment {sid: "EXP002"}), (g:Gene {symbol: "MTOR"})
CREATE (e)-[:HAS_VALUE {foldChange: -1.8, pValue: 0.01, regulated: "down"}]->(g)
MATCH (e:Experiment {sid: "EXP002"}), (g:Gene {symbol: "AKT1"})
CREATE (e)-[:HAS_VALUE {foldChange: 2.1, pValue: 0.002, regulated: "up"}]->(g)

// Connect Gene -> Protein
MATCH (g:Gene {symbol: "PIK3CG"}), (p:Protein {sid: "P48736"})
CREATE (g)-[:CODES]->(p)
MATCH (g:Gene {symbol: "CXCL10"}), (p:Protein {sid: "P02778"})
CREATE (g)-[:CODES]->(p)
MATCH (g:Gene {symbol: "MTOR"}), (p:Protein {sid: "P42345"})
CREATE (g)-[:CODES]->(p)
MATCH (g:Gene {symbol: "AKT1"}), (p:Protein {sid: "P31749"})
CREATE (g)-[:CODES]->(p)
MATCH (g:Gene {symbol: "PPARG"}), (p:Protein {sid: "P37231"})
CREATE (g)-[:CODES]->(p)

// Connect Gene -> ID
MATCH (g:Gene {symbol: "PIK3CG"}), (id:ID {sid: "5294"})
CREATE (g)-[:MAPPED]->(id)
MATCH (g:Gene {symbol: "CXCL10"}), (id:ID {sid: "3627"})
CREATE (g)-[:MAPPED]->(id)
MATCH (g:Gene {symbol: "MTOR"}), (id:ID {sid: "2475"})
CREATE (g)-[:MAPPED]->(id)

// Connect Gene -> Disease
MATCH (g:Gene {symbol: "PIK3CG"}), (d:Disease {sid: "MONDO:0005359"})
CREATE (g)-[:RELATED_TO {source: "DisGeNET", score: 0.75}]->(d)
MATCH (g:Gene {symbol: "PPARG"}), (d:Disease {sid: "MONDO:0005015"})
CREATE (g)-[:RELATED_TO {source: "OpenTargets", score: 0.85}]->(d)
MATCH (g:Gene {symbol: "MTOR"}), (d:Disease {sid: "MONDO:0005015"})
CREATE (g)-[:RELATED_TO {source: "DisGeNET", score: 0.68}]->(d)

// Connect Protein -> GO
MATCH (p:Protein {sid: "P48736"}), (go:GO {sid: "GO:0008286"})
CREATE (p)-[:ASSOCIATED_WITH {source: "GO"}]->(go)
MATCH (p:Protein {sid: "P02778"}), (go:GO {sid: "GO:0006954"})
CREATE (p)-[:ASSOCIATED_WITH {source: "GO"}]->(go)
MATCH (p:Protein {sid: "P42345"}), (go:GO {sid: "GO:0008286"})
CREATE (p)-[:ASSOCIATED_WITH {source: "GO"}]->(go)
MATCH (p:Protein {sid: "P31749"}), (go:GO {sid: "GO:0008286"})
CREATE (p)-[:ASSOCIATED_WITH {source: "GO"}]->(go)
MATCH (p:Protein {sid: "P37231"}), (go:GO {sid: "GO:0005158"})
CREATE (p)-[:ASSOCIATED_WITH {source: "GO"}]->(go)

// Add protein-protein interactions (extending the model)
MATCH (p1:Protein {sid: "P48736"}), (p2:Protein {sid: "P31749"})
CREATE (p1)-[:INTERACTS_WITH {source: "STRING", score: 0.9}]->(p2)
MATCH (p1:Protein {sid: "P31749"}), (p2:Protein {sid: "P42345"})
CREATE (p1)-[:INTERACTS_WITH {source: "STRING", score: 0.95}]->(p2)

----

== Cypher Queries

=== Which genes are overexpressed at both the mRNA (transcript) and protein levels in a given disease?

[source, cypher, role=noheader]
----
// Find genes that are upregulated both at the transcript (RNA-seq) and protein (proteomics) levels
MATCH (comp:Comparison {sid: "COMP001"})<-[:COMPARES]-(exp_trans:Experiment {type: "RNA-seq"})-[hv_trans:HAS_VALUE {regulated: "up"}]->(g:Gene)
WHERE hv_trans.foldChange > 1.5 AND hv_trans.pValue < 0.05
MATCH (exp_prot:Experiment {type: "Proteomics"})-[hv_prot:HAS_VALUE {regulated: "up"}]->(g)
WHERE hv_prot.foldChange > 1.2 AND hv_prot.pValue < 0.05
RETURN g.symbol AS Gene,
       hv_trans.foldChange AS TranscriptFoldChange,
       hv_prot.foldChange AS ProteinFoldChange,
       hv_trans.pValue AS TranscriptPValue,
       hv_prot.pValue AS ProteinPValue
ORDER BY ProteinFoldChange DESC, TranscriptFoldChange DESC;
----


=== Which proteins are in the network neighborhood of a candidate target?

[source, cypher, role=noheader]
----
// Find direct interacting proteins for PIK3CG
MATCH (g:Gene {symbol: "PIK3CG"})-[:CODES]->(p:Protein)-[i:INTERACTS_WITH]-(neighbor:Protein)<-[:CODES]-(ng:Gene)
RETURN g.symbol AS TargetGene,
       ng.symbol AS NeighborGene,
       neighbor.sid AS NeighborProtein,
       i.score AS InteractionScore
ORDER BY i.score DESC;

// Find proteins 1-2 hops away
MATCH path = (g:Gene {symbol: "PIK3CG"})-[:CODES]->(p:Protein)-[:INTERACTS_WITH*1..2]-(neighbor:Protein)<-[:CODES]-(ng:Gene)
RETURN g.symbol AS TargetGene,
       ng.symbol AS NeighborGene,
       length(path) AS Distance,
       [rel in relationships(path) | rel.score] AS InteractionScores;
----

=== What are the protein-protein interactions in 1–2 hops of my overexpressed genes from my RNA-seq?

[source, cypher, role=noheader]
----
// Find protein-protein interactions (1–2 hops) for overexpressed genes from RNA-seq (e.g., for COMP001 comparison)
MATCH (comp:Comparison {sid: "COMP001"})<-[:COMPARES]-(exp:Experiment {type: "RNA-seq"})-[hv:HAS_VALUE {regulated: "up"}]->(g:Gene)
WHERE hv.foldChange > 1.5 AND hv.pValue < 0.05
MATCH (g)-[:CODES]->(p:Protein)
MATCH path = (p)-[:INTERACTS_WITH*1..2]-(neighbor:Protein)
RETURN g.symbol AS SourceGene,
       p.sid AS SourceProtein,
       neighbor.sid AS NeighborProtein,
       length(path) AS Hops,
       [rel in relationships(path) | rel.score] AS InteractionScores
ORDER BY SourceGene, Hops DESC;
----

